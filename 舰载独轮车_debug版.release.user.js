// ==UserScript==
// @icon          https://www.youtube.com/favicon.ico
// @name          舰载型Youtube泥头车
// @author        necros & dislido
// @description   cv-6用舰载机：59改-谢斌
// @match         *://www.youtube.com/*
// @match         *://accounts.google.com/*
// @match         *://twitter.com/*
// @version       1.1.9
// @grant         unsafeWindow
// @grant         GM_xmlhttpRequest
// @grant         GM_log
// @grant         window.close
// @grant         GM_notification
// @grant         GM_setValue
// @grant         GM_getValue
// @connect       localhost
// @namespace     1551@andy.com
// ==/UserScript==
(()=>{var __webpack_modules__={182:(e,t,n)=>{n.d(t,{vc:()=>o,Dc:()=>l,$:()=>a,ME:()=>c});const o={accountNames:["AhiruJack","AIペンギン","Jello-mancy","John Mackregar","Johnson Yau","neloppu","OVERDRIVE !!","R","soab","Taylor Corey","Tom Meyey","Trash bin","Trash Box","Trash","TrashCan","TrashKing","Uncle George","W M","あみざる","けいてぃー","しゃんご","すてはん","せんせい,","ほんとろ","もはもはうごうご","ゆきうさぎ","ゆゆ2号","ゆゆ3号","ゆゆの魂","よん","らてん(Ratenn)","イプTommy","ウエポン","オモチ","カミジョー","ギウラトシ","クロッペkuroppe","サイタツ!","シャブの青藍","タツヒコ","チュングアス","ハイパーへきお","ハセ","ハンズトーン","パンドラ","フングス","マイネオアイチャン","ローマプロ市民","ーp00hy","坂本","巫女萌え","来人","松山チハル","桐生会直系龍心会","水没","白滝","白滝ゆび抜き","空下峠","錦山彰"],autoDownVote:!1,minDownVoteMin:300,maxDownVoteMin:360,minChangeChannel:20,maxChangeChannel:30,autoAttack:!1,cycleCheck:!0,gatlingAutoStop:!1,autoSCCheck:!1,channelsAll:[],channelsIndexCurr:0,channelsIndexStart:0,tokenLenMin:2,tokenLenMax:5,tokenDelayTime:1e3,tokenRefine:!0,tokenPruning:!0,url:"",autoSetupURL:!0,changeChannelCount:0,changeChannelTimerstamp:0,control:!0,controlPort:5e3,fireMode:0,ammoPiecingTimes:10,textAmmoPiecing:"",splitMode:2,minCycleSec:6,maxCycleSec:12,randomDanmaku:!1,text:"",maxDanmakuLength:200,minDanmakuLength:20,startTime:"2020-10-24 00:07:00",stopTime:"2020-10-24 00:07:00",splitChar:"，；：。！？…,.!?,",remoteDanmakuBase:"",noValidate:!1,modList:[],extension:"",lowConsume:!0,lowConsumeChat:!0,autoStop:!0,infoUrl:"",startWaitingTime:100,fullAutomation:!1,lastLiveUrl:"",recallMsg:!1,ammoRefine_Disturb:!0,ammoRefine_ToLower:!0,ammoRefine_Cloud:!1,ammoRefine_Local:!0,ammoRefine_BanedWordMode:0,ammoToLatin:!1,ammoRefineStategy:"https://raw.githubusercontent.com/aserwarsdfd/logs/main/carrier-based.json",nTags:3,twitter:{tags:{primary:{桐生ココ:!0,ココここ:!0,みかじ絵:!0},secondary:{"#たつのこ":!0,指示クラ:!0}},bibles:{很难不支持:{content:"很 难 不 支 持",format:!1}}}},l={suspension:"#9999CC",backgroundToast:"#CCCCFF",backgroundCmd:"#FFCCCC",titlebar:"#FF9999",border:"#FFCCCC",btn:"#996699",btnBorder:"#CCCCFF",btnColor:"#FFFFFF",textareaBackground:"#ffe5f2",textareaColor:"#4C3333",fontColor:"#4C3333",announcementHeader:"#5e4263",helpIconBackground:"#FFFFFF",helpIconColor:"#000000",collapseBackground1:"#ead6ea",collapseBackground2:"#CCCCFF",collapseBorder:"#cc99b3"},a=(e,t,n="carrierBasedDuluncheCfg")=>{o[e]=t,localStorage.setItem(n,JSON.stringify(o))},c=(e="carrierBasedDuluncheCfg")=>{try{const t=JSON.parse(localStorage.getItem(e));Object.assign(o,t)}catch(e){}o.modList.forEach((t=>{void 0===t.activate&&(t.activate=!0,localStorage.setItem(e,JSON.stringify(o)))}))}},368:(e,t,n)=>{n.d(t,{K:()=>r,L:()=>d});var o=n(555),l=n(182),a=n(274),c=n(750),i=n(659);const r={inited:!1,email:null,currChannel:null,currChannelID:"",nextChannel:null,channels:{},channelState:"?",addAccountButton:null,get:(e=!0)=>{if(r.inited){const t={};return t.email=r.email,t.banned=r.channelState,"?"==t.banned&&(t.banned="U"),t.currChannel=r.currChannel,t.currChannelID=r.currChannelID,t.channels=Object.keys(r.channels),t.timestamp=(new Date).getTime(),t.url=window.location.href,t.newConnection=e,t}return!1}};let s;const d=(e=!0,t=!1,n=(()=>{}))=>{const{control:m,autoDownVote:u,url:p}=l.vc;if(!m&&!u)return;if("https://www.youtube.com/"===window.location.href&&p.match(/.*:\/\/www\.youtube\.com\/watch.*/)&&l.vc.changeChannelCount>0)return l.vc.changeChannelCount=0,localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(l.vc)),void(window.location.href=p);if(!window.location.href.match(/.*:\/\/www\.youtube\.com\/watch.*/)&&!window.location.href.match(/.*:\/\/www\.youtube\.com\/?$/))return;if(!m&&!(0,o.jr)(window.location.href,p))return void(0,a.FN)(`目标直播间地址是${p}, 当前直播间地址是${window.location.href},不一致。不进行点踩操作`);let h=!1,g=document.getElementsByTagName("ytd-account-item-renderer");if(g.length>0){h=!0,g=Array.prototype.slice.call(g),t&&(console.log("setup curr account"),l.vc.channelsAll=[]);for(let e=0;e<g.length;e++){let n=g[e],o=n.children[0].children[1].children[0].innerText,a=n.parentNode.parentNode.children[0].innerText.replace(/[\r\n]/g,""),c=a.substr(0,a.indexOf("@")+1)+o;c in r.channels||(r.channels[c]=n,t&&l.vc.channelsAll.push(c)),r.inited||n.children[0].children[2].hidden||(r.inited=!0,r.currChannel=c,r.email=a,r.addAccountButton=n.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children[1].children[0].children[1].children[0].children[0])}console.log(r.currChannel),console.log(r.email),console.log(r.channels),console.log(l.vc.channelsAll);let s=(0,a.h)("div",{style:`\n            background: ${l.Dc.suspension};\n            color:${l.Dc.btnColor};\n            z-index: 800;\n            position: fixed;\n            padding: 5px;\n            text-align:center;\n            border-radius: 5px;\n            right: 10px;\n            top: 24%;\n          `},r.email);if(document.body.appendChild(s),t&&(l.vc.channelsIndexStart=l.vc.channelsAll.findIndex((e=>e===r.currChannel)),l.vc.channelsIndexCurr=l.vc.channelsIndexStart),console.log(`autoDownVote: ${u}`),u&&l.vc.channelsAll.length>0){let e=l.vc.channelsAll[(l.vc.channelsIndexCurr+1)%l.vc.channelsAll.length];console.log(`nextkey: ${e}`),r.nextChannel=r.channels[e],console.log(r.nextChannel)}m&&(0,c.N)(),u&&e&&((0,o.jr)(window.location.href,p)?(0,i.w7)():(0,a.FN)(`目标直播间地址是${p}, 当前直播间地址是${window.location.href},不一致。不进行点踩操作`)),n();try{document.getElementsByTagName("iron-dropdown")[0].style.display="none"}catch(e){console.log(e)}}else{const e=document.getElementsByClassName("yt-simple-endpoint style-scope ytd-compact-link-renderer")[3];if(null!=e){const t=document.getElementsByClassName("yt-simple-endpoint style-scope ytd-compact-link-renderer")[0].href.split("/");r.currChannelID=t[t.length-1],e.click()}else{const e=document.getElementById("avatar-btn");null!=e&&e.click()}}h||(s=setTimeout((()=>{d(e,t,n)}),2e3))};s=setTimeout(d,2e3)},750:(e,t,n)=>{n.d(t,{N:()=>h,S:()=>p});var o=n(803),l=n(555),a=n(182),c=n(368),i=n(996),r=n(144),s=n(274),d=n(659);const m=e=>{o.x.chatTxtInput.textContent=(0,r.e)(e.text,e.ammoRefine_Cloud,e.ammoRefine_Local,e.ammoRefine_Disturb,e.ammoRefine_ToLower,0),o.x.chatTxtInput.dispatchEvent(new InputEvent("input")),o.x.sendBtn.click()};var u=!1;const p=e=>{switch(console.log("handleServerCommand: "),console.log(e),e.command){case"stop":i.Y.emit("dlc.stop");break;case"run":if(!(0,l.jr)(window.location.href,(0,l.$t)(e.url.split("&")[0])))return void(window.location.href=(0,l.$t)(e.url.split("&")[0]));a.vc.splitMode=2,a.vc.fireMode=e.useAP?1:0,a.vc.text=e.ammo.join("\n"),a.vc.textAmmoPiecing=e.apAmmo.join("\n"),a.vc.randomDanmaku=e.randomDanmaku,a.vc.minCycleSec=e.minCycleSec,a.vc.maxCycleSec=e.maxCycleSec,a.vc.ammoRefine_Cloud=e.ammoRefine_Cloud,a.vc.ammoRefine_Local=e.ammoRefine_Local,a.vc.ammoRefine_Disturb=e.ammoRefine_Disturb,a.vc.ammoRefine_ToLower=e.ammoRefine_ToLower,i.Y.emit("dlc.run");break;case"jump":(0,l.jr)(window.location.href,(0,l.$t)(e.url.split("&")[0]))||(window.location.href=(0,l.$t)(e.url.split("&")[0]));break;case"send":if(!u){let t=e.timestamp-(new Date).getTime();setTimeout((()=>m(e)),t),t<=0?m(e):(setTimeout((()=>{m(e),u=!1}),t),u=!0)}break;case"downvote":(0,l.Ux)();break;case"swap":try{if(a.vc.changeChannelCount=1,a.vc.url=window.location.href,localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(a.vc)),unsafeWindow.waitForDownvote){if("false"===document.getElementsByClassName("style-scope ytd-menu-renderer force-icon-button")[1].getElementsByTagName("button")[0].getAttribute("aria-pressed")&&0==o.x.dlcDownvoteEndTime){let e=(0,l.Iy)(1e3*a.vc.minDownVoteMin,1e3*Math.max(a.vc.minDownVoteMin,a.vc.maxDownVoteMin));(0,s.FN)(`舰载机挂踩插件运行中 - 过${e/1e3}s点踩。为了保证挂踩时间，涉及到切换频道的操作均会被推迟。`),d.RB=setTimeout((()=>{(0,l.Ux)(!1)}),e),o.x.dlcDownvoteEndTime=(new Date).getTime()+e+1e3*a.vc.minChangeChannel}let t=o.x.dlcDownvoteEndTime-(new Date).getTime();t>0?((0,s.FN)(`现在还没挂够点踩时间，${t/1e3}s后换频道。`),setTimeout((()=>{c.K.channels[e.channel_name].click()}),t)):c.K.channels[e.channel_name].click()}else c.K.channels[e.channel_name].click()}catch(t){console.log("Fail to change channel"),console.log(e)}break;case"change":null!=c.K.addAccountButton&&setTimeout((()=>{window.open(c.K.addAccountButton.href,"_self").focus()}),1e3);break;case"createChannel":i.Y.emit("dlc.createChannel",e.accountName);break;default:console.log("invalid command: "+e)}},h=()=>{0==o.x.CVServer&&(o.x.CVServer=new WebSocket(`ws://localhost:${a.vc.controlPort}/`)),o.x.CVServer&&(o.x.CVServer.onopen=()=>{let e=c.K.get(!0);e&&o.x.CVServer.send(JSON.stringify(e))},o.x.CVServer.onmessage=e=>{let t=JSON.parse(e.data);i.Y.emit("dlc.handleServerCommand",t)},o.x.CVServer.onerror=()=>{o.x.CVServer=!1,setTimeout((()=>{a.vc.control&&h()}),2e4)},o.x.CVServer.onclose=()=>{o.x.CVServer=!1})};o.x.handleServerCommand=p},601:(e,t,n)=>{n.d(t,{mi:()=>m,pj:()=>d,rC:()=>s});var o=n(555),l=n(182),a=n(274);const c=e=>{let t=decodeURI(window.location.href).split("&");for(let n=0;n<t.length;n++){let o=t[n].split("=");if(o[0]==e)return o[1]}return!1},i=(e,t=!1)=>{(0,o.Xi)((()=>e.document.getElementById("avatar-btn")),(n=>{n.click(),(0,o.Xi)((()=>t?e.document.getElementsByClassName("style-scope iron-dropdown")[0].getElementsByTagName("a")[1]:e.document.getElementsByClassName("yt-simple-endpoint style-scope ytd-compact-link-renderer")[0]),(t=>{t.click(),(0,o.Xi)((()=>e.document.getElementById("next-button").children[0].children[0].children[0]),(t=>{t.click(),(0,o.Xi)((()=>e.document.getElementById("personal-account-tile-select-button").children[0].children[0].children[0]),(t=>{t.click();const n=()=>{try{let t=e.location.href;console.log(t),setTimeout(n,3e3)}catch(t){e.close(),window.close()}};n()}))}))}))}))};var r;const s=()=>{let e;console.log("创建频道页面");const t=(e,t=(()=>{}),n=5)=>{let c=[["h1",{style:"color: red"},`即将创建频道: ${e}`],["h1",{id:"countdown",style:"color: red"},`倒计时: ${n}`],(0,a.h)([["button",{class:"dlc-btn",$click:()=>{clearTimeout(r),GM_setValue("createExtraChannels",""),document.getElementById("countdown").innerText="已取消创建新频道。"}},"取消倒计时"]])],i=n;const s=()=>setTimeout((()=>{i--,document.getElementById("countdown").innerText=`倒计时: ${i}`,0==i?(0,o.Xi)((()=>document.getElementById("PlusPageName")),(n=>{((e,t,n)=>{e.value=n,t()})(n,(()=>{let e=document.getElementById("submitbutton");e.focus(),e.click(),GM_setValue("createExtraChannels",""),setTimeout((()=>{t()}),2e3)}),e)})):r=s()}),1e3);return r=s(),(0,a.h)("div",{style:`color: ${l.Dc.fontColor}`},c)};(0,o.Xi)((()=>unsafeWindow.dulunche),(()=>{let n=c("channelMain"),o=c("channelExtra");n&&o?(e=n,(0,a.FN)(t(e,(()=>{setTimeout((()=>{window.open("https://www.youtube.com/channel_switcher?next=%2Faccount&feature=settings")}),2e3)})))):(e=GM_getValue("createExtraChannels",""),e&&(GM_setValue("createExtraChannels",""),(0,a.FN)(t(e))))}))},d=()=>{(0,o.Xi)((()=>document.getElementById("avatar-btn")),(()=>{console.log("New UI"),i(window,!0)})),(0,o.Xi)((()=>document.getElementsByClassName("page-info-text text-line")[0].parentElement.parentElement.parentElement.parentElement),(e=>{console.log("OldUI");for(let t=0;t<document.getElementsByClassName("page-info-text text-line").length;t++){let n=document.getElementsByClassName("page-info-text text-line")[t].innerText;if(e=document.getElementsByClassName("page-info-text text-line")[t].parentElement.parentElement.parentElement.parentElement,n.match(/.*@.*/)){console.log("主账号");let t=window.open(e.href);i(t,!1)}}}))},m=e=>{e||alert("accountName is empty!");let t=window.open("https://www.youtube.com/create_channel");return window.focus(),setTimeout((()=>{"https://www.youtube.com/create_channel"!=t.location.href?((0,a.FN)(`创建1个副频道，频道名为${e}`),t.close(),GM_setValue("createExtraChannels",e),window.open("https://www.youtube.com/create_channel?action_create_new_channel_redirect=true")):((0,a.FN)(`创建主频道+1个副频道，副频道名字为${e}`),(0,o.Xi)((()=>t.document.getElementsByClassName("create-channel-plus-page-link")[0]),(t=>{t.href=t.href+`&channelMain=${e}&channelExtra=${e}&channelState=main`,t.click()})))}),2e3),t}},126:(e,t,n)=>{n.d(t,{w:()=>l,s:()=>a});var o=n(451);const l=(()=>{try{const e=new XMLHttpRequest;return e.open("GET","https://raw.githubusercontent.com/aserwarsdfd/logs/main/carrier-based.json",!1),e.send(),JSON.parse(e.responseText)}catch(e){return{version:"1.1.9",logs:"1.0.0:舰载型独轮车初代 现已和单兵独轮车代码分离",announcement:"！！！绝对不要用绑定了银行卡的账号！！！\n关闭舰载机模式后，舰载独轮车可以像单兵独轮车那样使用。开启了舰载机模式后不要用舰载机加特林模式点踩",regexs:[],block_words:[],ytb_block_words:[],replace_words:{re:"are",ay:"any"},phantom_tank:!1}}})(),a=(e=>{if(!e)return{};let t={};return e.forEach((e=>{let n=(0,o.v)(e),l=t;for(let e=0;e<n.length&&l;e++)e==n.length-1?l[n[e]]=!1:(n[e]in l||(l[n[e]]={}),l=l[n[e]])})),t})(l.ytb_block_words.concat(l.block_words))},996:(e,t,n)=>{n.d(t,{Y:()=>_,T:()=>k});var o=n(803),l=n(182),a=n(144);o.x.sendMsg=e=>{o.x.chatTxtInput.textContent=e,o.x.chatTxtInput.dispatchEvent(new InputEvent("input")),o.x.sendBtn.click()};var c=n(555),i=n(750),r=n(601),s=n(125),d=n(274),m=n(368),u=n(659);const p=()=>{const{autoSetupURL:e}=l.vc;e&&(l.vc.url=window.location.href),l.vc.url=(0,c.$t)(l.vc.url.split("&")[0]),l.vc.url.match(/.*:\/\/www\.youtube\.com\/watch.*/)?(l.vc.autoDownVote=!0,l.vc.changeChannelCount=0,l.vc.changeChannelTimerstamp=Date.now(),o.x.autoDownVoteBtn.innerText="加特林停火",console.log("加特林启动"),(0,m.L)(!1,!0,u.w7)):(0,d.FN)("请在油管直播间使用这个功能！")},h=()=>{l.vc.autoDownVote=!1,l.vc.changeChannelCount=0,o.x.autoDownVoteBtn.innerText="加特林开火",_.emit("dlc.stop"),void 0!==u.MB&&clearTimeout(u.MB),void 0!==u.RB&&clearTimeout(u.RB)},g=()=>{const{fireMode:e}=l.vc;o.x.fetchNative||(o.x.fetchNative=document.getElementById("chatframe").contentWindow.fetch,document.getElementById("chatframe").contentWindow.fetch=async function(...t){let n;const l="string"==typeof t[0]?t[0]:t[0].url;let a;try{a=new URL(l).pathname}catch(e){a=""}return a.endsWith("/send_message")&&1==e?(o.x.armorPiercingTimeoutId&&(clearTimeout(o.x.armorPiercingTimeoutId),o.x.armorPiercingTimeoutId=void 0),o.x.armorPiercingTimeoutId=setTimeout((()=>{null===o.x.armorPiercingResolve||void 0===o.x.armorPiercingResolve||o.x.armorPiercingResolve(),o.x.armorPiercingTimeoutId=void 0,o.x.armorPiercingPromise=void 0,o.x.armorPiercingResolve=void 0}),233),o.x.armorPiercingPromise||(o.x.armorPiercingPromise=new Promise((e=>{o.x.armorPiercingResolve=e}))),n=await o.x.armorPiercingPromise.then((()=>o.x.fetchNative.apply(this,t)))):n=await o.x.fetchNative.apply(this,t),n})};let x;const b={0:e=>[e.substr(0,l.vc.maxDanmakuLength)],2:e=>e.split("\n").map((e=>e.trim().substr(0,l.vc.maxDanmakuLength))).filter(Boolean),1:e=>{const{maxDanmakuLength:t,minDanmakuLength:n,splitChar:o}=l.vc,a=[];return e.trim().replace(/\s+/g," ").split(new RegExp(`(?<=[${o.replace(/(\\|])/g,"\\$1")}])`)).reduce(((e,o,l,c)=>{for(e+=o;e.length>t;)a.push(e.substr(0,t)),e=e.substr(t);return l===c.length-1?(a.push(e),""):e.length<n?e:(a.push(e),"")}),""),a}},f=()=>{const{autoDownVote:e,maxCycleSec:t,minCycleSec:n,minDownVoteMin:i,maxDownVoteMin:r,minChangeChannel:s,text:m,splitMode:p,randomDanmaku:h,fireMode:f,textAmmoPiecing:v}=l.vc;if(!e)if(unsafeWindow.waitForDownvote&&!u.RB){let e=(0,c.Iy)(1e3*i,1e3*Math.max(i,r));(0,d.FN)(`舰载机挂踩插件运行中 - 过${e/1e3}s点踩。为了保证挂踩时间，涉及到切换频道的操作均会被推迟。`),u.RB=setTimeout((()=>{(0,c.Ux)(!1)}),e),o.x.dlcDownvoteEndTime=(new Date).getTime()+e+1e3*s}else(0,c.Ux)();if(!l.vc.noValidate)try{o.x.configValidators.forEach((e=>e()))}catch(e){(0,d.FN)(e)}let y;if(localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(l.vc)),0==f){const e=b[p](m);y=o.x.remoteDanmakuConfig.filter(Boolean).reduce(((e,t)=>e.concat(t.list)),e)}else l.vc.ammoPiecingTimes>10&&((0,d.FN)("穿甲弹同时开火次数不要大于10，会被风控射不出来, 已经帮你改小了"),l.vc.ammoPiecingTimes=10),y=b[p](v).map((e=>(0,a.l)(e)));if(!y.length)return void(0,d.FN)("当前弹幕列表为空！");g(),o.x.runBtn.innerText="中止";const w=parseInt(1e3*n,10),C=parseInt(1e3*t,10);let k;o.x.danmakuGener=function*(){if(2==+p&&h)for(;;)yield y[(0,c.Iy)(0,y.length-1)];else for(;;)yield*y}(),k=0==f?(e=!1)=>{let t=w,n=C;e&&(t=1e3,n=1e3),x=setTimeout((async()=>{_.emit("dlc.sendMsg",(await o.x.danmakuGener.next()).value),x&&k()}),(0,c.Iy)(t,n))}:(e=!1)=>{let t=w,n=C;e&&(t=1e3,n=1e3),x=setTimeout((async()=>{for(let e=0;e<l.vc.ammoPiecingTimes;e++)_.emit("dlc.sendMsg",(await o.x.danmakuGener.next()).value);x&&k()}),(0,c.Iy)(t,n))},k(beg=!0)},v=()=>{o.x.runBtn.innerText="出动",o.x.ambushBtn.innerText="伏击",o.x.fetchNative&&(document.getElementById("chatframe").contentWindow.fetch=o.x.fetchNative),o.x.fetchNative=void 0,clearTimeout(x),x=null};let y="";const w=()=>{(0,c.Ux)(),(0,d.FN)("准备伏击 越共探头.jpg"),o.x.ambushBtn.innerText="撤退";const e=unsafeWindow.frames.chatframe.contentDocument.getElementsByTagName("yt-live-chat-text-message-renderer");e&&e.length>0&&(y=e[e.length-1].id);const t=()=>{x=setTimeout((()=>{let e=!1;const n=unsafeWindow.frames.chatframe.contentDocument.getElementsByTagName("yt-live-chat-text-message-renderer");for(let t=n.length-1;t>=0;t--){const l=n[t];if(l.id==y)break;if("Coco Ch. 桐生ココ"===l.getElementsByTagName("yt-live-chat-author-chip")[0].children["author-name"].innerText&&"出动"===o.x.runBtn.innerText){const t=l.textContent||l.innerText;(0,d.FN)(`${String(new Date)}发现目标！开火！${t}`),e=!0,o.x.runBtn.click()}}n&&n.length>0&&(y=n[n.length-1].id),e||t()}),2e3)};t()},C=()=>{o.x.ambushBtn.innerText="伏击",_.emit("dlc.stop")},_={ee:new EventTarget,on(e,t,n,o=Symbol("dlc.event.type.anonymous")){return this.fnMap.set(o,t),this.ee.addEventListener(e,t,n),o},off(e,t,n){this.ee.removeEventListener(e,t,n)},emit(e,t){const n=new CustomEvent(e,{detail:t});this.ee.dispatchEvent(n)},fnMap:new Map},k=()=>{_.on("dlc.ready",(()=>{o.x.autoPlayBtn.active&&o.x.autoPlayBtn.click()})),_.on("setRef.remoteDanmakuConfig",(({detail:e})=>{o.x.remoteDanmakuConfig=e})),_.on("dlc.sendMsg",(({detail:e})=>{const{recallMsg:t,fireMode:n}=l.vc;let c=((e,t)=>{let n=t?(0,a.l)(e):e;return o.x.sendMsg(n),n})(e,0==n);t&&setTimeout((()=>{_.emit("dlc.recallMsg",c)}),2e3)}),{},"dlc.sendMsg.default"),_.on("dlc.recallMsg",(({detail:e})=>{(e=>{const t=unsafeWindow.frames.chatframe.contentDocument.getElementsByTagName("yt-live-chat-text-message-renderer");for(let n=t.length-1;n>=0;n--){const o=t[n],l=o.children[1].children[2].innerText;if(e.trim()===l){o.children[2].children[0].click(),(0,c.Xi)((()=>unsafeWindow.frames.chatframe.contentDocument.getElementsByTagName("ytd-menu-popup-renderer")[0].children[0].children),(e=>{1==e.length&&e[0].click()}),500);break}}})(e)}),{},"dlc.recallMsg.default"),_.on("dlc.handleServerCommand",(({detail:e})=>{(0,i.S)(e)}),{},"dlc.handleServerCommand.default"),_.on("dlc.createChannel",(({detail:e})=>(0,r.mi)(e)),{},"dlc.createChannel.default"),_.on("dlc.ready",s.k$),_.on("dlc.controlOnchange",(()=>{l.vc.control=!l.vc.control,localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(l.vc)),l.vc.control&&!m.K.inited&&(console.log("setup account info"),(0,m.L)())}),{},"dlc.controlOnchange.default"),_.on("dlc.run",f,{},"dlc.run.default"),_.on("dlc.stop",v,{},"dlc.stop.default"),_.on("dlc.gatlingrun",p,{},"dlc.gatlingrun.default"),_.on("dlc.gatlingstop",h,{},"dlc.gatlingstop.default"),_.on("dlc.ambush",w,{},"dlc.ambush.default"),_.on("dlc.retreat",C,{},"dlc.retreat.default")}},659:(e,t,n)=>{n.d(t,{RB:()=>s,MB:()=>d,w7:()=>u});var o=n(555),l=n(182),a=n(803),c=n(996),i=n(274),r=n(368);let s,d;const m=(e,t)=>{const{autoDownVote:n,cycleCheck:o,gatlingAutoStop:a}=l.vc;if((0,i.FN)(`此频道点踩完毕，过${t/1e3}s换号`),l.vc.channelsIndexCurr=(l.vc.channelsIndexCurr+1)%l.vc.channelsAll.length,!o&&l.vc.channelsIndexCurr==l.vc.channelsIndexStart)return c.Y.emit("dlc.gatlingstop"),localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(l.vc)),void(a?((0,i.FN)("成功点踩完一圈。停手，并在10s后关闭窗口。"),setTimeout((()=>{window.close()}),1e4)):(0,i.FN)("成功点踩完一圈。停手"));n&&(t>0?d=setTimeout((()=>{n&&e&&(l.vc.changeChannelCount=1,localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(l.vc)),e.click())}),t):e&&(l.vc.changeChannelCount=1,localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(l.vc)),e.click()))},u=()=>{const{autoDownVote:e,minDownVoteMin:t,maxDownVoteMin:n,minChangeChannel:d,maxChangeChannel:u,autoAttack:p}=l.vc;console.log("delay downvote");let h=parseInt((Date.now()-l.vc.changeChannelTimerstamp)/6e4);if(h>15)return(0,i.FN)(`上次延迟点踩在${parseInt(h/60)}小时${parseInt(h%60)}分钟前，加特林可能忘记停火了。因此帮您自动停火`),c.Y.emit("dlc.gatlingstop"),void localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(l.vc));if(l.vc.changeChannelTimerstamp=Date.now(),p&&"出动"===a.x.runBtn.innerText&&a.x.runBtn.click(),document.getElementsByClassName("style-scope ytd-menu-renderer force-icon-button")[1].classList.contains("style-text")){let l=(0,o.Iy)(1e3*t,1e3*Math.max(t,n));(0,i.FN)(`加特林正在转动，过${l/1e3}s点踩`),s=setTimeout((()=>{e&&((0,o.Ux)(!1),m(r.K.nextChannel,(0,o.Iy)(1e3*d,1e3*Math.max(d,u))))}),l)}else console.log("这个频道点过踩了"),m(r.K.nextChannel,(0,o.Iy)(1e3*d,1e3*Math.max(d,u)))}},125:(e,t,n)=>{n.d(t,{k$:()=>i,$0:()=>r,Bg:()=>d});var o=n(182),l=n(803),a=n(996),c=n(274);const i=()=>{setTimeout((()=>{l.x.offlineStateDiv=document.querySelector(".ytp-offline-slate-main-text"),l.x.offlineStateDiv.innerText?i():(o.vc.autoStop&&l.x.offlineStateDiv.addEventListener("DOMNodeInserted",s),a.Y.emit("live.start"),console.log("Live start"))}),1e4)},r=(e,t,n=!1,l=!1)=>{fetch(e).then((e=>e.json())).then((e=>{if(!e||!e.currentLives)return t.checked=!1,void(0,c.FN)((0,c.h)("monitor",{style:{color:"red"}},["数据格式有误， 请使用正确的api"]));if(l)return void(e.currentLives[0]||(window.location="https://www.youtube.com/"));if(!e.currentLives[0])return void(0,c.FN)("监控中");const{link:n}=e.currentLives[0];n!==o.vc.lastLiveUrl?((0,o.$)("lastLiveUrl",n),window.location=n):(0,c.FN)("刚冲过了, 休息中, 等待监控API刷新")})).catch((e=>{console.error(e),n||(t.checked=!1,(0,o.$)("fullAutomation",!1)),(0,c.FN)((0,c.h)("monitor",{style:{color:"red"}},[`加载错误 ${e}`]))}))},s=e=>{"感谢收看"===e.target.data&&(a.Y.emit("dlc.gatlingstop"),a.Y.emit("live.stop"),window.location="https://www.youtube.com")},d=()=>{setInterval((()=>{try{const e=document.getElementById("chatframe").contentWindow,t=e.document.querySelector("#send-button button"),n=e.document.querySelector("#input.yt-live-chat-text-input-field-renderer");t&&(l.x.sendBtn=t),n&&(l.x.chatTxtInput=n)}catch(e){}}),6e4)}},264:(e,t,n)=>{n.d(t,{y:()=>i,x:()=>r});var o=n(182),l=n(274),a=n(358);const c=(e,t,n=null)=>{const{modList:c}=o.vc;t?(null===n?c.push({modName:e||"未命名MOD",mod:t,activate:!0}):c[n]={modName:e||"未命名MOD",mod:t,activate:!0},localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(o.vc)),(0,l.FN)("保存MOD成功,请刷新页面以使用"),(0,a.W)()):(0,l.FN)("无效mod")},i=(e={modName:"",mod:""},t=0)=>{const{modName:n,mod:o}=e,a=Boolean(n);return(0,l.h)("form",{style:{"max-width":"500px"},id:"add-mod",$submit:e=>{e.preventDefault(),a?c(e.target.modName.value,e.target.mod.value,t):c(e.target.modName.value,e.target.mod.value)}},[["input",{value:n,type:"text",name:"modName",placeholder:"MOD名称"}],["button",{type:"submit",class:"dlc-btn"},"保存"],["textarea",{value:o,name:"mod",class:"dlc-textarea",placeholder:"扩展脚本，这里的代码会在独轮车初始化前eval执行",style:{width:"100%",height:"300px",overflow:"scroll",whiteSpace:"pre"},form:"add-mod"},o]])},r=(e,t)=>{const n=["input",{type:"checkbox",$click:({target:e})=>{o.vc.modList[t].activate=e.checked,localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(o.vc))}}];return e.activate&&(n[1].checked="checked"),["div",{style:{display:"flex","justify-content":"flex-end"}},[["span",{style:{"font-size":"15px",flex:1}},e.modName],n,["button",{$click:()=>{(0,l.FN)(i(e,t))}},"编辑"],["button",{$click:()=>{0===t?o.vc.modList.shift():o.vc.modList.splice(t,t),localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(o.vc)),(0,a.W)()}},"删除"]]]}},358:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>modManager,l:()=>runMods});var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(182),_modules_ui_utils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(274),_modules_mod_mod_edit_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(264);const modManager=(e="singletonDom")=>{const{modList:t}=_config_js__WEBPACK_IMPORTED_MODULE_0__.vc;modManager[e]&&modManager[e].remove();const n=(0,_modules_ui_utils_js__WEBPACK_IMPORTED_MODULE_1__.h)("div",{class:"dlc-mod-mgr"},[["button",{class:"dlc-btn",$click:()=>{n.remove()}},"关闭"],["button",{class:"dlc-button",$click:()=>{(0,_modules_ui_utils_js__WEBPACK_IMPORTED_MODULE_1__.FN)((0,_modules_mod_mod_edit_js__WEBPACK_IMPORTED_MODULE_2__.y)())}},"添加mod"],...t.map(_modules_mod_mod_edit_js__WEBPACK_IMPORTED_MODULE_2__.x)]);modManager[e]=n,document.body.appendChild(n)},runMods=()=>{if(_config_js__WEBPACK_IMPORTED_MODULE_0__.vc.modList)try{_config_js__WEBPACK_IMPORTED_MODULE_0__.vc.modList.forEach((_mod=>{_mod.activate&&eval(_mod.mod)}))}catch(e){console.error(e),(0,_modules_ui_utils_js__WEBPACK_IMPORTED_MODULE_1__.FN)("扩展脚本运行失败，错误信息已输出到控制台")}}},144:(e,t,n)=>{n.d(t,{l:()=>s,e:()=>r});var o=n(182),l=n(451),a=n(555),c=n(126);const i=(e,t)=>{e=e.filter((e=>!/[\u2E80-\u9FFF]/.test(e)));let n=[];for(let o=0;o<e.length;o++){let l=e[o];if(/[A-Za-z]/.test(l))switch(+t){case 0:break;case 1:const e=(0,a.Iy)(0,l.length-1);let o=l.codePointAt(e);90===o?o=65:122===o?o=97:o+=1;let i=l.slice(0,e)+String.fromCodePoint(o)+l.slice(e+1,l.length);try{c.w.block_words.indexOf(i.toLowerCase())>-1||n.push(i)}catch(e){n.push(i)}break;default:console.log(`屏蔽词：${l} 模式: ${t} 尚未编写`)}else n.push(l)}return n},r=(e,t=!1,n=!1,o=!1,r=!1,s=!1)=>{let d=[],m=[],u=e.match(/:[a-zA-Z_]+:/);if(u){do{m.push(e.substr(0,u.index)),d.push(u[0]),u=(e=e.substr(u.index+u[0].length)).match(/:[a-zA-Z_]+:/)}while(u);m.push(e)}else m.push(e);if(m=m.map((e=>{if(n&&(e=(e=>{e=(e=(e=(e=e.replace(/’|‘/g,"'").replace(/“|”/g,'"')).replace(/【/g,"[").replace(/】/g,"]").replace(/｛/g,"{").replace(/｝/g,"}")).replace(/，、/g,",").replace(/：/g,":")).replace(/。/g,".").replace(/：/g,":");let t="";for(let n=0;n<e.length;n++)12288!==e.codePointAt(n)?e.codePointAt(n)>65280&&e.codePointAt(n)<65375?t+=String.fromCharCode(e.codePointAt(n)-65248):t+=String.fromCharCode(e.codePointAt(n)):t+=String.fromCharCode(e.codePointAt(n)-12256);return t})(e)),r&&(e=(e=e.toLowerCase()).replace(/[[\]?.!-;,:',，。、“”！？"]+/g," ")),n)for(let t in c.w.regexs)e=e.replace(new RegExp(t),c.w.regexs[t]);let t=(0,l.v)(e);return n&&(t=((e,t,n)=>{let o=[],l=0,a=0,c=!1,r=!1,s=t;for(l=0;l<e.length;l++){if(c)if(s){if(r&&!/[A-Za-z]/.test(e[l])&&!/[\u2E80-\u9FFF]/.test(e[l]))continue;if(e[l].toLowerCase()in s)s=s[e[l].toLowerCase()];else{for(c=!1,s=t;a<l;a++)o.push([e[a]]);l--}}else o.push(i(e.slice(a,l),n)),c=!1,s=t,l-=1;else e[l].toLowerCase()in s?(a=l,c=!0,s=s[e[l].toLowerCase()]):o.push([e[l]]);/[A-Za-z]/.test(e[l])&&(r=!0),/[\u2E80-\u9FFF]/.test(e[l])&&(r=!1)}if(c)if(s)for(;a<l;a++)o.push([e[a]]);else o.push(i(e.slice(a,l),n));return o.reduce(((e,t)=>e.concat(t)),[])})(t,c.s,s)),t.join("")})),o){let e=(0,a.Iy)(0,m.length-1);m[e]=(e=>{const t=e.trim().split(/\s{1,}/);if(t.length>0){const e=(0,a.Iy)(0,t.length-1),n=[...t[e]];n.splice((0,a.Iy)(0,n.length-1),1),t[e]=n.join("")}return t.join(" ")})(m[e])}e=m[0];for(let t=0;t<d.length;t++)e=e+d[t]+m[t+1];return e},s=e=>{const{ammoRefine_Cloud:t,ammoRefine_Local:n,ammoRefine_Disturb:l,ammoRefine_ToLower:a,ammoRefine_BanedWordMode:c}=o.vc;return r(e,t,n,l,a,c)}},451:(e,t,n)=>{n.d(t,{v:()=>a});const o=/([^A-Za-z0-9\u2E80-\u9FFF])/,l=/([\u2E80-\u9FFF])/,a=e=>e?e.split(o).reduce(((e,t)=>e.concat(t.split(l).filter((e=>e)))),[]):[]},484:(e,t,n)=>{n.d(t,{n:()=>c});var o=n(274),l=n(182),a=n(555);const c=(e,t,n,c="")=>{let i=(0,a.Uo)(e)<(0,a.Uo)(t),r=[];return c&&(r=r.concat([(0,o.$g)(l.Dc.border,"2px"),["h1",{style:`color: ${l.Dc.announcementHeader}`},"舰载机广播塔"]]).concat(c.split("\n").map((e=>["div",{},e])))),r=r.concat([(0,o.$g)(l.Dc.border,"2px"),["h1",{style:"color: red"},i?"更新提示: ":""],["div",{},i?`您的版本为: ${e}, 最新版为: ${t}, 建议更新最新版`:"您的独轮车是最新版，不需要更新"],(0,o.h)([["button",{class:"dlc-btn",$click:()=>{window.location.href="https://script.cocosuki.xyz/jianzaiji.user.js"}},i?"更新版本(源1)":"重新安装(源1)"]]),(0,o.h)([["button",{class:"dlc-btn",title:"尚未实装",$click:()=>{}},i?"更新版本(备用源)":"重新安装(备用源)"]]),(0,o.h)([["button",{class:"dlc-btn",$click:()=>{window.open("https://bbs.nga.cn/read.php?tid=25074183")}},"使用指南(未实装)"]]),(0,o.h)([["button",{class:"dlc-btn",$click:()=>{window.location.href="https://bbs.nga.cn/read.php?tid=25006545"}},"问题反馈"]])]),i&&(n=n.filter((t=>(0,a.Uo)(t.split(":")[0])>(0,a.Uo)(e))),r=r.concat([(0,o.$g)(l.Dc.border,"2px"),["h2",{style:`color: ${l.Dc.announcementHeader}`},"更新日志: "],["div",{},n.map((e=>["div",{},[["h3",{},e.split(":")[0]],["div",{},e.split(":")[1].split("\n").map((e=>["div",{},e]))],(0,o.$g)("#808080","1px")]]))]])),(0,o.h)("div",{style:`color: ${l.Dc.fontColor}`},r)}},274:(e,t,n)=>{n.d(t,{h:()=>c,FN:()=>i,$g:()=>r,bE:()=>s,y7:()=>d,JJ:()=>m});var o=n(182),l=n(996),a=n(555);const c=(e,t={},n=[],o={})=>{if(e instanceof Node)return e;if(e instanceof Array){const t=document.createDocumentFragment();return e.forEach((e=>{e instanceof Node?t.appendChild(e):Array.isArray(e)?t.appendChild(c(e[0],e[1],e[2],e[3])):(["string","number"].includes(typeof e)||e)&&t.appendChild(new Text(e))})),t}const l=document.createElement(e);return Object.entries(t).forEach((([e,t])=>{"style"===e&&"object"==typeof t?Object.assign(l.style,t):e.startsWith("$")?"function"==typeof t?l.addEventListener(e.slice(1),t):l.addEventListener(e.slice(1),t.handleEvent,t):l.setAttribute(e,t)})),["string","number"].includes(typeof n)?l.textContent=n:n&&l.appendChild(c(n)),"function"==typeof o?o(l):o.cb&&o.cb(l),l},i=(e,t="dlc-toast",n="singletonDom",o=(()=>{}))=>{i[n]&&i[n].remove();const l=c("div",{class:t,style:{zIndex:++i.currZIndex}},[["button",{class:"dlc-btn",$click:()=>{l.remove(),i[n]=null,o()}},"关闭"],["div",{style:"font-size: 120%;"},e]]);"dlc-alert"===t&&setTimeout((()=>l.remove()),1e4),i[n]=l,document.body.appendChild(l)};i.currZIndex=1e4;const r=(e,t)=>["div",{style:`height: 1px;border-top: ${t} solid ${e}; text-align: center;`},""],s=({label:e,type:t,name:n,props:a={},children:c=[],valueProp:r="value",helpDesc:s},d)=>["div",{},[s&&["span",{class:"help-icon",$click:e=>{e.stopPropagation(),i(s)}}],["label",{},[e,[t,{...a,$change:e=>{l.Y.emit(`setConfig.${n}`,e.target[r]),a.$change&&a.$change(e)}},c,e=>{e[r]=o.vc[n],l.Y.on(`setConfig.${n}`,(({detail:t})=>{o.vc[n]=t,e[r]=t}),{},`dlc.setConfig.${n}.default`)}]]]],d],d=(e,t,n="")=>(t[0][1].style=`border-top:1px solid;border-top-left-radius: 5px;border-top-right-radius: 5px;${t[0][1].style}`,t[t.length-1][1].style=`border-bottom:1px solid;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;${t[t.length-1][1].style}`,["div",{},[n&&["span",{class:"help-icon",$click:e=>{e.stopPropagation(),i(n)}}],["label",{},[["details",{},[["summary",{style:`background-color: ${o.Dc.collapseBackground1};border:1px solid;border-radius:5px;border-color: ${o.Dc.collapseBorder};`},e]].concat(t.map((e=>(e[1].style=`background-color: ${o.Dc.collapseBackground2};border-right:1px solid; border-left:1px solid;border-color: ${o.Dc.collapseBorder};${e[1].style}`,e))))]]]]]),m=(e,t="测试用定型文",n=!1)=>["div",{},[[c([["button",{class:"dlc-btn",$click:()=>{(0,a.qb)(t,"",!1)}},"复制"],["label",{},[e]]])]]]},803:(e,t,n)=>{n.d(t,{x:()=>c,d:()=>i});var o=n(182),l=n(996),a=n(274);const c={sendBtn:null,autoDownVoteBtn:null,chatTxtInput:null,autoPlayBtn:null,runBtn:null,runAmmoTestBtn:null,runAmmoAnalysisBtn:null,offlineStateDiv:null,remoteDanmakuConfig:[],dlcAutomation:null,duluncheWnd:null,CVServer:!1,dlcDownvoteEndTime:0,fetchNative:void 0,armorPiercingTimeoutId:void 0,armorPiercingPromise:void 0,armorPiercingResolve:void 0,configValidators:[()=>Number(o.vc.minCycleSec)<1&&l.Y.emit("setConfig.minCycleSec",1),()=>Number(o.vc.minDanmakuLength)<1&&l.Y.emit("setConfig.minDanmakuLength",1),()=>Number(o.vc.maxDanmakuLength)<o.vc.minDanmakuLength&&l.Y.emit("setConfig.maxDanmakuLength",o.vc.minDanmakuLength)],danmakuGener:null,configFieldContainer:null,helpContent:null,init:async()=>{try{const e=document.getElementById("chatframe").contentWindow;return c.sendBtn=e.document.querySelector("#send-button button"),c.chatTxtInput=e.document.querySelector("#input.yt-live-chat-text-input-field-renderer"),c.offlineStateDiv=document.querySelector(".ytp-offline-slate-main-text"),c.autoPlayBtn=document.querySelector("paper-toggle-button"),!(!c.sendBtn||!c.chatTxtInput)}catch(e){return!1}}};c.helpContent=[["button",{class:"dlc-btn",$click:()=>{(0,a.FN)("老版独轮车扩展脚本已经迁移到MOD管理, 并且会在未来版本中删除")}},"编辑扩展脚本"],["pre",{},"\n  API开发指南，在window.dulunche获取引用，TS定义如下\n  /**\n  * 独轮车配置，这是一个Proxy对象，你可以直接获取和设置配置，通过这个对象设置配置项时，也会向eventBus提交一个emit(`setConfig.${配置项名称}`, value)事件\n  * config对象在每次启动时会保存到localStorage的duluncheCfg中\n  */\n  interface ConfigType {\n  /** 断句方式0: 单句模式 1: 说书模式 2: 多句转轮 */\n  splitMode: number;\n  /** 最小发送间隔（秒） */\n  minCycleSec: number;\n  /** 最大发送间隔（秒） */\n  maxCycleSec: number;\n  /** 是否随机发送 */\n  randomDanmaku: boolean;\n  /** 发送消息列表 */\n  text: string;\n  /** 最大弹幕字数限制 */\n  maxDanmakuLength: number;\n  /** 最小弹幕长度 */\n  minDanmakuLength: number;\n  /** 断句符 */\n  splitChar: string;\n  /** 远程弹幕库 */\n  remoteDanmakuBase: string;\n  /** 不校验配置，即不运行configValidators, 设为true是，所有配置项都不会限制输入范围 */\n  noValidate: boolean;\n  /** 扩展脚本，独轮车初始化前会eval执行这个脚本 */\n  extension: string;\n\n  [key: string]: any;\n  }\n\n  /**\n  * 独轮车事件总线，可以在这里监听和触发各种事件\n  */\n  interface DuluncheEventBus {\n  /** 用来绑定事件的EventTarget对象，通常不需要直接操作这个对象 */\n  ee: EventTarget;\n  /** 监听事件，addEventListener, 会返回一个key用于从fnMap获取监听器引用，这个key可以手动指定，默认是一个Symbol */\n  on<T = any>(\n  type: string,\n  fn: (detail: CustomEvent<T>) => void,\n  opt?: boolean | AddEventListenerOptions, fnKey?: string | Symbol\n  ): string | Symbol;\n  /** 取消监听事件，removeEventListener */\n  off<T = any>(type: string, fn: (detail: CustomEvent<T>) => void, opt?: boolean | AddEventListenerOptions): any;\n  /** 触发事件，dispatchEvent */\n  emit<T = any>(type: string, detail: T): void;\n  /** 已经注册的事件监听器map，可以通过key拿到事件监听器的引用 */\n  fnMap: Map<string | Symbol, (detail: CustomEvent) => void>;\n  }\n\n  /** 独轮车内部一些引用，修改它们可以改变独轮车原本的一些行为 */\n  interface DuluncheRefs {\n  /** 配置项校验器，独轮车会在dlc.run开始时依次执行数组中的每个函数 */\n  configValidators: Array<() => void>\n  /** 独轮车控制台窗口dom引用 */\n  duluncheWnd: HTMLDivElement;\n  /** 独轮车配置列表dom引用 */\n  configFieldContainer: HTMLDivElement;\n  /** 弹幕生成器，独轮车通过调用danmakuGener.next().value来获取下一条要发送的弹幕，弹幕生成器只能在独轮车启动状态下被替换，最早是dlc.run的下一次事件循环 */\n  danmakuGener: GeneratorFunction;\n  /** 独轮车帮助信息内容 */\n  helpContent: any;\n  /** 初始化函数，若没有返回true则会等待1秒后重新执行，初始化成功会触发dlc.ready事件，默认行为是获取油管直播页聊天输入框和发送按钮引用，可以是异步函数 */\n  init: () => boolean | Promise<boolean>;\n\n  [key: string]: any;\n  }\n\n  interface Window {\n  dulunche: {\n  config: ConfigType;\n  eventBus: DuluncheEventBus,\n  refs: DuluncheRefs,\n\n  /** 组件和渲染器，建议看过源码后使用 */\n  components: {\n  Toast: (children: string | Node, singletonId?: string) => void;\n  ConfigField: (...args: any) => HTMLDivElement;\n  h: (...args: any) => Node;\n  }\n  };\n  }\n\n  /**\n  eventBus 默认的事件列表, 你可以通过emit主动触发事件，或通过on监听事件\n  事件名 | 事件 | detail参数类型 | detail参数说明\n  dlc.run | 启动独轮车 | void | -\n  dlc.stop | 停止独轮车 | void | -\n  dlc.sendMsg | 发送消息 | string | 发送的内容\n  dlc.ready | 初始化成功 | void | -\n  setConfig.${configKey} | 修改配置 | any | 修改的配置值\n  live.start| 监控到直播已经开始 | void\n  live.stop | 监控到直播已经结束 | void\n  */\n  "]];const i=async()=>{let e;try{e=await c.init()}catch(e){}!0!==e?setTimeout((()=>i()),1e3):l.Y.emit("dlc.ready")}},555:(e,t,n)=>{n.d(t,{Iy:()=>c,jr:()=>i,qb:()=>r,Uo:()=>s,Ye:()=>d,Xi:()=>m,$t:()=>u,Ux:()=>p,mr:()=>h});var o=n(126),l=n(274),a=n(484);const c=(e,t)=>t<e?e:Math.floor(Math.random()*(t-e+1)+e),i=(e,t)=>e.split("&")[0]===t.split("&")[0],r=(e,t,n=!0)=>{console.log("copyToClip");var o=document.createElement("textarea");o.value=e,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),n&&(null==t?alert("复制成功"):alert(t))},s=e=>parseInt(e.replace(/\./g,"")),d=e=>{s(e)<s(o.w.version)&&((0,l.FN)(`您的版本为: ${e}, 最新版为: ${o.w.version}, 建议更新最新版本。\n更新日志: \n    ${o.w.logs}`),console.log("test"),(0,l.FN)((0,a.n)(oldVersion=e,newVersion=o.w.version,logs=o.w.logs.split(";"))))},m=(e,t,n=3e3)=>{let o;try{if(o=e(),!o)return void setTimeout((()=>m(e,t,n)),n)}catch(o){return void setTimeout((()=>m(e,t,n)),n)}t(o)},u=e=>{if(e.match(/.*:\/\/youtu\.be\/.*/)){let t=e.split("/");return`${t[0]}//www.youtube.com/watch?v=${t[t.length-1]}`}return e},p=(e=!0)=>{const t=document.getElementById("channel-name").getElementsByClassName("yt-simple-endpoint style-scope yt-formatted-string")[0].text;var n;e&&"Coco Ch. 桐生ココ"!==t||"false"===(n=document.getElementsByClassName("style-scope ytd-menu-renderer force-icon-button")[1]).getElementsByTagName("button")[0].getAttribute("aria-pressed")&&n.click()},h=e=>`${Math.floor(e/3600)}:${Math.floor(e/60%60)}:${Math.floor(e%60)}`}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=__webpack_require__(555),t=__webpack_require__(182),n=__webpack_require__(803),o=__webpack_require__(996),l=__webpack_require__(274);const a=(e=!0)=>{try{const t=document.querySelector("#player.style-scope").style,n=document.getElementById("movie_player").classList.contains("paused-mode"),o=document.querySelector(".ytp-play-button.ytp-button");e?(t.display="none",n||o.click()):(t.display="block",n&&o.click())}catch(e){}},c=(e=!0)=>{try{document.getElementById("chatframe").contentDocument.getElementById("chat").style.display=e?"none":""}catch(e){}};var i=__webpack_require__(358),r=__webpack_require__(144),s=__webpack_require__(368);let d;const m=(e="",t=((e,t)=>{}))=>{try{2==document.getElementById("chatframe").contentDocument.getElementById("picker-buttons").children.length&&document.getElementById("chatframe").contentWindow.checkSuperChat(e).then((n=>{t(e,(e=>{let t="?";return t="用户未登录或SuperChat不可用"===e.error?"U":null==e.error?"T":"F",t})(n))}),(()=>{}))}catch(e){}},u=()=>{const{control:e,autoSCCheck:o}=t.vc;if(e||o){if("T"!=s.K.channelState&&"?"!=s.K.channelState)return;m("",((e,t)=>{if(t!=s.K.channelState){s.K.channelState=t;const e=s.K.get(!1);e&&n.x.CVServer&&n.x.CVServer.send(JSON.stringify(e))}}))}"T"!=s.K.channelState&&"?"!=s.K.channelState||(d=setTimeout(u,6e4))};let p;d=setTimeout(u,3e4);var h=__webpack_require__(125);let g;const x=s=>(0,l.h)("div",{class:"dlc-cmd"},[["div",{class:"dlc-titlebar",$mousedown(e){if(e.target!==this)return;const t=(0,l.h)("div",{style:{position:"fixed",left:"0",top:"0",width:"100vw",height:"100vh"}});this.style.cursor="all-scroll",document.body.appendChild(t);const{layerX:o,layerY:a}=e,c=e=>{n.x.duluncheWnd.style.left=e.clientX-o+"px",n.x.duluncheWnd.style.top=e.clientY-a+"px"};document.addEventListener("mousemove",c),document.addEventListener("mouseup",(()=>{document.removeEventListener("mousemove",c),this.style.cursor="",t.remove()}),{once:!0})}},[["button",{class:"dlc-btn",$click:e=>{e.stopPropagation(),"出动"===n.x.runBtn.innerText?o.Y.emit("dlc.run"):o.Y.emit("dlc.stop")}},"出动",e=>{n.x.runBtn=e}],["span",{class:"help-icon",$click:e=>{e.stopPropagation(),(0,l.FN)(n.x.helpContent)}}],["span",{class:"import-export-icon",title:"复制独轮车参数到剪贴板",$click:n=>{n.stopPropagation(),(0,e.qb)(JSON.stringify(t.vc))}},"",e=>{e.insertAdjacentHTML("afterbegin",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="display: block;margin: 20%;">\x3c!-- Font Awesome Free 5.15.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path d="M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"></path></svg>')}],["span",{class:"import-export-icon",title:"导入独轮车参数",$click:e=>{e.stopPropagation(),(0,l.FN)(((e={newConfig:""})=>{const{newConfig:o}=e;return(0,l.h)("form",{style:{"max-width":"500px"},id:"edit-config",$submit:e=>{let o;e.preventDefault();try{o=JSON.parse(e.target.newConfig.value)}catch(e){return void alert("无法解析输入的参数字符串！建议检查下复制的对不对")}Object.assign(t.vc,o),document.body.removeChild(n.x.duluncheWnd),n.x.duluncheWnd=x(),document.body.appendChild(n.x.duluncheWnd),n.x.duluncheWnd.style.setProperty("display","block"),localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(t.vc)),(0,l.FN)("设置已保存")}},[["button",{type:"submit",class:"dlc-btn"},"保存"],["textarea",{value:o,name:"newConfig",class:"dlc-textarea",placeholder:"请把复制出的参数粘贴在这儿",style:{width:"100%",height:"50px",overflow:"scroll",whiteSpace:"pre"},form:"edit-config"},o]])})())}},"",e=>{e.insertAdjacentHTML("afterbegin",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="margin: 20%;display: block;">\x3c!-- Font Awesome Free 5.15.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\x3e<path d="M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"></path></svg>')}],`v${s}`,["div",{},[["label",{title:"开启/关闭舰载机模式"},[(0,l.bE)({name:"control",type:"input",props:{class:"mui-switch",type:"checkbox",onchange:'window.dulunche.eventBus.emit("dlc.controlOnchange");'},valueProp:"checked"})]]]],["div",{class:"dlc-close-btn",style:"position: absolute; right: 0;",$click:e=>{e.stopPropagation(),n.x.duluncheWnd.style.setProperty("display","none")}},"X"]]],["div",{style:{margin:"0 auto"}},[(0,l.bE)({label:"",name:"text",type:"textarea",props:{class:"dlc-textarea",placeholder:"输入常规模式需要发射的内容到这里",style:{width:"265px",height:"100px",overflow:"scroll",whiteSpace:"pre"}}}),(0,l.bE)({label:"",name:"textAmmoPiecing",type:"textarea",props:{class:"dlc-textarea",placeholder:"输入穿甲弹发射的内容到这里",style:{width:"265px",height:"50px",overflow:"scroll",whiteSpace:"pre"}}}),["div",{},[["button",{class:"dlc-btn",$click:e=>{e.stopPropagation(),"伏击"===n.x.ambushBtn.innerText?o.Y.emit("dlc.ambush"):o.Y.emit("dlc.retreat")}},"伏击",e=>{n.x.ambushBtn=e}],["button",{class:"dlc-btn",$click:e=>{t.vc.control?(0,l.FN)("请先关闭舰载机模式"):(t.vc.autoDownVote?o.Y.emit("dlc.gatlingstop"):o.Y.emit("dlc.gatlingrun"),localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(t.vc)))}},"加特林开火",e=>{n.x.autoDownVoteBtn=e,t.vc.autoDownVote?n.x.autoDownVoteBtn.innerText="加特林停火":(o.Y.emit("dlc.gatlingstop"),localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(t.vc)))}],["button",{class:"dlc-btn",$click:()=>{localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(t.vc)),p&&(clearTimeout(p),p=void 0),(0,l.FN)((()=>{const o="#F583B4",a="#9BC768",c=()=>{let e=[],t=document.getElementById("dlc-ammotest-text").children,n=document.getElementById("dlc-ammotest-textAP").children;for(let n=0;n<t.length;n++)e.push(t[n]);for(let t=0;t<n.length;t++)e.push(n[t]);return e};let i=["div",{id:"dlc-ammotest-text"},t.vc.text.split("\n").filter((e=>e.trim())).map((e=>["div",{style:"background-color:#C6C09C;"},e]))],s=["div",{id:"dlc-ammotest-textAP"},t.vc.textAmmoPiecing.split("\n").filter((e=>e.trim())).map((e=>["div",{style:"background-color:#C6C09C;"},e]))];return(0,l.h)("div",{style:{"max-width":"500px"}},[["button",{class:"dlc-btn",$click:()=>{if(p)return clearTimeout(p),p=void 0,n.x.runAmmoTestBtn.innerText="开始测试",n.x.runAmmoAnalysisBtn.innerText="屏蔽词分析",void((t.vc.connect||t.vc.autoSCCheck)&&setTimeout(u,6e4));n.x.runAmmoTestBtn.innerText="测试中",clearTimeout(d),m("",((e,l)=>{if("T"!=l)setTimeout(u,6e4),n.x.runAmmoTestBtn.innerText="开始测试",alert("无法打SC, 可能的原因有 直播间未开启SC/频道被封/频道名有屏蔽词");else{let e=c();if(0==e.length)return;t.vc.tokenRefine&&e.forEach((e=>{e.textContent=(0,r.l)(e.textContent)}));let l=0,i=(c,r)=>{e[l].valid="T"==r;let s=e[l].valid?a:o;e[l++].style=`background-color: ${s};`,l<e.length&&"测试中"===n.x.runAmmoTestBtn.innerText?t.vc.tokenDelayTime>0?p=setTimeout((()=>{m(e[l].innerText,i)}),t.vc.tokenDelayTime):m(e[l].innerText,i):((t.vc.connect||t.vc.autoSCCheck)&&setTimeout(u,6e4),n.x.runAmmoTestBtn.innerText="开始测试",p=void 0)};m(e[l].innerText,i)}}))}},"开始测试",e=>{n.x.runAmmoTestBtn=e}],["button",{class:"dlc-btn",$click:()=>{const e=e=>{let t=[];for(let n=0;n<e.length;n++)e[n].valid&&t.push(e[n].innerText);return t.join("\n")};let o=document.getElementById("dlc-ammotest-text").children,l=document.getElementById("dlc-ammotest-textAP").children;t.vc.text=e(o),t.vc.textAmmoPiecing=e(l),document.body.removeChild(n.x.duluncheWnd),n.x.duluncheWnd=x(),document.body.appendChild(n.x.duluncheWnd),n.x.duluncheWnd.style.setProperty("display","block")}},"装填可用弹药"],["button",{class:"dlc-btn",$click:()=>{let t=c().filter((e=>null!=e.valid)).map((e=>({text:e.innerText,valid:e.valid}))),n={timestamp:(new Date).getTime(),ammos:t};(0,e.qb)(JSON.stringify(n)),alert("已将SC测试的结果复制到剪贴板。您可以在NGA屏蔽词总结贴中分享您测试的结果。")}},"导出结果"],(0,l.$g)(t.Dc.border,"2px"),(0,l.y7)("高级",[(0,l.bE)({label:"最短屏蔽词长度",name:"tokenLenMin",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"检查的最短屏蔽词长度"}),(0,l.bE)({label:"最长屏蔽词长度",name:"tokenLenMax",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"检查的最长屏蔽词长度。更长的就不检查了"}),(0,l.bE)({label:"SC检测间隔时间(ms)",name:"tokenDelayTime",type:"input",props:{type:"number",min:0,style:{width:"48px",margin:"1px"}},helpDesc:"每次SC检测之间的间隔时间"}),(0,l.bE)({label:"检测精炼后弹药",name:"tokenRefine",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"打SC前先根据当前精炼设置，将弹药精炼。建议开启。"}),["button",{class:"dlc-btn",style:`background-color:  ${t.Dc.btn};`,$click:()=>{if(p)return clearTimeout(p),n.x.runAmmoTestBtn.innerText="开始测试",n.x.runAmmoAnalysisBtn.innerText="屏蔽词分析",p=void 0,void((t.vc.connect||t.vc.autoSCCheck)&&setTimeout(u,6e4));let e=c().filter((e=>null!=e.valid&&!e.valid));if(0==e.length)return;n.x.runAmmoAnalysisBtn.innerText="分析中...",clearTimeout(d);let i=document.getElementById("dlc-ammoAnalysis"),r=i.lastElementChild;for(;r;)i.removeChild(r),r=i.lastElementChild;let s=[];e.forEach((e=>{let n=e.innerText,o=[],a=t.vc.tokenLenMax+1;n.length<a&&(a=n.length);for(let e=t.vc.tokenLenMin;e<a;e++)for(let t=0;t<n.length-e+1;t++)o.push(n.substr(t,e));let c=o.map((e=>["dt",{style:"background-color:#C6C09C;"},e]));c=[["summary",{style:"background-color:#F583B4;"},n]].concat(c);let r=(0,l.h)("details",{},c);i.appendChild(r);for(let e=0;e<r.children.length;e++)s.push(r.children[e])}));let h=0,g=(e,l)=>{s[h].valid="T"==l;let c=s[h].valid?a:o;s[h++].style=`background-color: ${c};`,h<s.length?t.vc.tokenDelayTime>0&&"分析中..."===n.x.runAmmoAnalysisBtn.innerText?p=setTimeout((()=>{m(s[h].innerText,g)}),t.vc.tokenDelayTime):m(s[h].innerText,g):((t.vc.connect||t.vc.autoSCCheck)&&setTimeout(u,6e4),clearTimeout(p),p=void 0,n.x.runAmmoAnalysisBtn.innerText="屏蔽词分析")};m(s[h].innerText,g)}},"屏蔽词分析",e=>{n.x.runAmmoAnalysisBtn=e}]]),(0,l.$g)(t.Dc.border,"2px"),["div",{},[["div",{},"您可以将弹药检测的结果分享到"],["a",{href:"https://ngabbs.com/read.php?tid=25288041"},"https://ngabbs.com/read.php?tid=25288041"],["div",{},"这样科技组可以从中分析屏蔽词"],["div",{},"屏蔽词分析词语长度最短为2个字符，最长为5个字符。更短/更长的屏蔽词请手动测试"],["div",{},"另外虫直播间除了屏蔽词以外还有白名单词。在测试屏蔽词的时候请多加注意。"]]],(0,l.$g)(t.Dc.border,"2px"),["div",{},[i,(0,l.$g)(t.Dc.border,"2px"),s,(0,l.$g)(t.Dc.border,"2px"),["div",{id:"dlc-ammoAnalysis"},[]]]]])})(),toastClass="dlc-toast",singletonId="ammoSCCheck",onClose=()=>{p&&(clearTimeout(p),p=void 0)})}},"弹药检测"]]],(0,l.bE)({label:"开火模式:",name:"fireMode",type:"select",children:[{value:"0",text:"常规模式"},{value:"1",text:"穿甲模式"}].map((({text:e,value:t})=>["option",{value:t},e])),helpDesc:"常规模式:正常开火；穿甲模式: 连续开火，击穿慢速护甲"}),(0,l.bE)({label:"穿甲弹开火次数:",name:"ammoPiecingTimes",type:"input",props:{type:"number",min:1,max:10,placeholder:1,style:{width:"48px",margin:"1px"}},helpDesc:"穿甲弹同时开火的次数，越多穿甲效果越明显，但是也会增加被google风控的概率"},(e=>{1!=+t.vc.fireMode&&e.classList.add("hide"),o.Y.on("setConfig.fireMode",(({detail:t})=>{"1"!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.fireMode.ammoPiecingTimesField")})),(0,l.bE)({label:"自动撤回",name:"recallMsg",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"自动撤回发出的弹药迷惑扳手，注意！请设置较长的开火时间间隔（最短5s以上），此功能能否生效受电脑卡顿因素影响，不要依赖这个开火"},(e=>{0!=+t.vc.fireMode&&e.classList.add("hide"),o.Y.on("setConfig.fireMode",(({detail:t})=>{"0"!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.recallMsg.recallMsgField")})),(0,l.bE)({label:"最小间隔时间(s):",name:"minCycleSec",type:"input",props:{type:"number",min:3,placeholder:3,style:{width:"48px",margin:"1px"}}}),(0,l.bE)({label:"最大间隔时间(s):",name:"maxCycleSec",type:"input",props:{type:"number",min:3,placeholder:3,style:{width:"48px",margin:"1px"}},helpDesc:"如果设置小于最小间隔时间，则相当于不随机间隔，以最小间隔时间发送弹幕"}),(0,l.bE)({label:"省流模式",name:"lowConsume",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"只看聊天框，节省流量"},(()=>{const{lowConsume:e}=t.vc;e&&o.Y.on("dlc.ready",a),o.Y.on("setConfig.lowConsume",(({detail:e})=>{a(e)}))})),(0,l.bE)({label:"关闭聊天框滚动",name:"lowConsumeChat",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"关闭聊天框滚动显示，降低多开时系统显示占用"},(()=>{const{lowConsumeChat:e}=t.vc;e&&o.Y.on("dlc.ready",c),o.Y.on("setConfig.lowConsumeChat",(({detail:e})=>{c(e)}))})),(0,l.bE)({label:"弹药扰动",name:"ammoRefine_Disturb",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"随机去除弹药中的一个字符，提高上top chat概率"}),(0,l.bE)({label:"断句方式:",name:"splitMode",type:"select",children:[{value:"2",text:"多句转轮"},{value:"0",text:"单句模式"},{value:"1",text:"说书模式"}].map((({text:e,value:t})=>["option",{value:t},e])),helpDesc:"多句转轮:每条弹幕一行；单句模式:不断行；说书模式:按表单符号与说书长度下限断行"}),(0,l.bE)({label:"随机弹幕:",name:"randomDanmaku",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"随机弹幕: 是否随机从弹幕列表选取弹幕发送，仅用于多句转轮模式；在说书模式启用会导致内容混乱"},(e=>{2!=+t.vc.splitMode&&e.classList.add("hide"),o.Y.on("setConfig.splitMode",(({detail:t})=>{"2"!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.splitMode.randomDanmakuField")})),(0,l.bE)({label:"说书长度下限:",name:"minDanmakuLength",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"说书长度下限: 仅说书模式生效，断句时会尽量控制弹幕长度在此之上"},(e=>{1!=+t.vc.splitMode&&e.classList.add("hide"),o.Y.on("setConfig.splitMode",(({detail:t})=>{"1"!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.splitMode.minDanmakuLengthField")})),(0,l.bE)({label:"说书断句符:",name:"splitChar",type:"input",props:{type:"text",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"说书断句符: 说书模式下以配置的符号分割文章为多条弹幕后，再合并到说书长度下限以上的弹幕长度，为空时固定按说书长度下限断句"},(e=>{1!=+t.vc.splitMode&&e.classList.add("hide"),o.Y.on("setConfig.splitMode",(({detail:t})=>{"1"!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.splitMode.splitCharField")})),(0,l.bE)({label:"自动停车",name:"autoStop",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"自动刹车，可能有bug"},(()=>{o.Y.on("setConfig.autoStop",(({detail:e})=>{if(e)n.x.offlineStateDiv.addEventListener("DOMNodeInserted",bindStop);else try{n.x.offlineStateDiv.removeEventListener("DOMNodeInserted",bindStop)}catch(e){}}))})),(0,l.bE)({label:"自动SC检测",name:"autoSCCheck",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"勾选后此独轮车每分钟会自动进行sc检测"}),(0,l.bE)({label:"关闭配置项校验:",name:"noValidate",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"不对输入的配置项进行校验，这意味着你可以进行将间隔时间设置为0这样的危险操作"}),(0,l.y7)("弹药精炼: 调整弹药内容，降低被杀几率",[(0,l.bE)({label:"弹药去除大写字母标点符号",name:"ammoRefine_ToLower",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"所有大写字母转换为小写，删除一切标点符号 - 对Nightbot策略"}),(0,l.bE)({label:"弹药精制 (本地)",name:"ammoRefine_Local",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"将弹药内容精制（如去除屏蔽词，改中文标点符号等， 正则替换等，以提高弹药通过Night bot的几率"}),(0,l.bE)({label:"弹药精制策略:",name:"ammoRefineStategy",type:"input",props:{type:"text",style:{width:"150px",margin:"1px"}}}),(0,l.bE)({label:"屏蔽词处理方式:",name:"ammoRefine_BanedWordMode",type:"select",children:[{value:"0",text:"删除屏蔽词"},{value:"1",text:"扰动屏蔽词"},{value:"2",text:"伪装屏蔽词 (测试)"}].map((({text:e,value:t})=>["option",{value:t},e])),helpDesc:"删除屏蔽词: 把屏蔽词直接删除; 扰动屏蔽词: 随机改动屏蔽词中的一个字母; 伪装屏蔽词: 启动屏蔽词伪装, 在特殊战役时期允许解放使用"},(e=>{!0!==t.vc.ammoRefine_Local&&e.classList.add("hide"),o.Y.on("setConfig.ammoRefine_Local",(({detail:t})=>{!0!==t?e.classList.add("hide"):e.classList.remove("hide")}),{},"dlc.setConfig.ammoRefine_Local.banedWordField")}))]),(0,l.y7)("智能发车: 定时或通过监控api来发车",[(0,l.bE)({label:(0,l.h)(["全自动发车:",["input",{type:"checkbox",$click:({target:e})=>{const{infoUrl:n}=t.vc;if(!e.checked)return clearInterval(g),void(0,t.$)("fullAutomation",!1);(0,t.$)("fullAutomation",!0),"https://www.youtube.com/"===window.location.href?((0,l.FN)("监控中..."),(0,h.$0)(n,e),g=setInterval((()=>(0,h.$0)(n,e,!0)),6e4)):(0,l.FN)("只能在油管首页开启监控, 回到首页刷新即可")}}]]),name:"infoUrl",type:"textarea",props:{class:"dlc-textarea",placeholder:"开播监控地址",style:{width:"245px",height:"50px",whiteSpace:"pre"}},helpDesc:"填监控API地址，如果不知道是什么，去NGA翻独轮车发布贴"},(e=>{const{fullAutomation:n,infoUrl:o,lastLiveUrl:a}=t.vc,c=e.querySelector("input");window.location.href===a&&setInterval((()=>(0,h.$0)(o,c,!0,!0)),6e4),n&&(c.checked=!0),n&&""!==o&&"https://www.youtube.com/"===window.location.href&&(c.checked=!0,(0,l.FN)("监控中..."),(0,h.$0)(o,c),g=setInterval((()=>(0,h.$0)(o,c,!0)),6e4))})),(0,l.bE)({label:"开播等待时间(s)",name:"startWaitingTime",type:"input",props:{type:"number",min:5,placeholder:t.vc.startWaitingTime,style:{width:"48px",margin:"1px"}}},(()=>{const{fullAutomation:e}=t.vc;e&&o.Y.on("live.start",(()=>{const{startWaitingTime:e}=t.vc;(0,l.FN)(`独轮车将于${e}秒后启动，如果这不是你的本意，请关闭全自动发车`,"dlc-alert"),setTimeout((()=>{o.Y.emit("dlc.run")}),1e3*e)}))})),(0,l.bE)({label:(0,l.h)([["button",{class:"dlc-btn",$click:({target:n})=>{if("定时启动"!==n.innerText)return;const{startTime:l}=t.vc,a=Date.parse(new Date(l));let c=a-(new Date).getTime();n.innerText=(0,e.mr)(parseInt(c/1e3));const i=()=>{setTimeout((()=>{c>0?(c=a-(new Date).getTime(),n.innerText=(0,e.mr)(parseInt(c/1e3)),i()):(o.Y.emit("dlc.run"),n.innerText="定时启动")}),1e3)};i()}},"定时启动"]]),name:"startTime",type:"input",props:{type:"text",min:1,style:{width:"150px",margin:"1px"}}}),(0,l.bE)({label:(0,l.h)([["button",{class:"dlc-btn",$click:({target:n})=>{if("定时结束"!==n.innerText)return;const{stopTime:l}=t.vc,a=Date.parse(new Date(l));let c=a-(new Date).getTime();n.innerText=(0,e.mr)(parseInt(c/1e3));const i=()=>{setTimeout((()=>{c>0?(c=a-(new Date).getTime(),n.innerText=(0,e.mr)(parseInt(c/1e3)),i()):(o.Y.emit("dlc.stop"),n.innerText="定时结束")}),1e3)};i()}},"定时结束"]]),name:"stopTime",type:"input",props:{type:"text",min:1,style:{width:"150px",margin:"1px"}}})]),(0,l.y7)("远程弹幕库",[(0,l.bE)({label:(0,l.h)(["加载远程弹幕库:",["button",{class:"dlc-btn",$click:({target:e})=>{if("更新"!==e.innerText)return;e.innerText="更新中...";const{remoteDanmakuBase:a}=t.vc,c=a.split("\n").map((e=>e.trim())).filter(Boolean),i=new Set,r=new Set,s=[],d=t=>{r.has(t)||(i.add(t),r.add(t),fetch(t).then((e=>e.json())).then((e=>{e?(Array.isArray(e.extends)&&e.extends.forEach((e=>d(e))),Array.isArray(e.list)&&s.push(e)):s.push({error:`[获取失败]${t}`})})).catch((e=>{console.error(e),s.push({error:`[获取失败]${t}`})})).finally((()=>{i.delete(t),0===i.size&&(o.Y.emit("setRef.remoteDanmakuConfig",s),e.innerText="更新",(0,l.FN)((0,l.h)("pre",{style:{color:"blue"}},n.x.remoteDanmakuConfig.map((e=>e.error||`${e.name||"匿名弹幕库"}: ${e.list.length}条`)).join("\n"))))})))};c.forEach((e=>d(e)))}},"更新"],["span",{},"(未加载弹幕库)",e=>{o.Y.on("setRef.remoteDanmakuConfig",(({detail:t})=>{const n=t.reduce(((e,t)=>e+(t&&t.list.length||0)),0);e.innerText=`(已加载${n}条)`}))}]]),name:"remoteDanmakuBase",type:"textarea",props:{class:"dlc-textarea",placeholder:"支持多个网址，每个一行",style:{width:"265px",height:"70px",overflow:"scroll",whiteSpace:"pre"}},helpDesc:"从指定地址加载弹幕列表，支持添加多个地址，每个一行；远程弹幕列表会添加到本地弹幕列表后；更新的弹幕会在下次出动时生效"})]),(0,l.y7)("舰载机配置: cv-6相关配置",[(0,l.bE)({label:"cv-6指挥端口:",name:"controlPort",type:"input",props:{type:"number",min:0,placeholder:3,style:{width:"48px",margin:"1px"}},helpDesc:"cv-6服务器端口，一般保持默认即可"})]),(0,l.y7)("加特林模式: 切频道点踩开火相关配置",[(0,l.bE)({label:"自动开火",name:"autoAttack",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"如果不勾选就只切频道+挂踩"}),(0,l.bE)({label:"无限循环",name:"cycleCheck",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"如果不勾选则循环一轮后便停火，不再切频道开火/点踩"}),(0,l.bE)({label:"自动关闭网页",name:"gatlingAutoStop",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"未勾选无限循环的情况下，所有号踩完一圈之后自动关闭标签页"}),(0,l.bE)({label:"目标直播间",name:"url",type:"input",props:{type:"text",style:{width:"150px",margin:"1px"}},helpDesc:"开火的直播间地址"}),(0,l.bE)({label:"自动设置直播间地址",name:"autoSetupURL",type:"input",props:{type:"checkbox"},valueProp:"checked",helpDesc:"是否在加特林开火时候自动用当前直播间地址开火"}),(0,l.bE)({label:"点踩最小间隔时间(s):",name:"minDownVoteMin",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"挂满这么长时间后再点踩"}),(0,l.bE)({label:"点踩最大间隔时间(s):",name:"maxDownVoteMin",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}}}),(0,l.bE)({label:"换号最小间隔时间(s):",name:"minChangeChannel",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}},helpDesc:"（点过踩以后）继续挂满这么长时间后再换号"}),(0,l.bE)({label:"换号最大间隔时间(s):",name:"maxChangeChannel",type:"input",props:{type:"number",min:1,style:{width:"48px",margin:"1px"}}})]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{localStorage.setItem("carrierBasedDuluncheCfg",JSON.stringify(t.vc)),(0,l.FN)("保存成功")}},"保存配置"]]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{(0,i.W)()}},"MOD管理"]]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{o.Y.emit("dlc.createChannel",t.vc.accountNames[(0,e.Iy)(0,t.vc.accountNames.length-1)])}},"新号开频道"]])],e=>{n.x.configFieldContainer=e}]]),b=t=>{let o=[(0,l.JJ)("很难不支持"),(0,l.JJ)("赢麻了")];return(0,l.h)("div",{class:"dlc-cmd"},[["div",{class:"dlc-titlebar",$mousedown(e){if(e.target!==this)return;const t=(0,l.h)("div",{style:{position:"fixed",left:"0",top:"0",width:"100vw",height:"100vh"}});this.style.cursor="all-scroll",document.body.appendChild(t);const{layerX:o,layerY:a}=e,c=e=>{n.x.duluncheWnd.style.left=e.clientX-o+"px",n.x.duluncheWnd.style.top=e.clientY-a+"px"};document.addEventListener("mousemove",c),document.addEventListener("mouseup",(()=>{document.removeEventListener("mousemove",c),this.style.cursor="",t.remove()}),{once:!0})}},[`v${t}`,["div",{class:"dlc-close-btn",style:"position: absolute; right: 0;",$click:e=>{e.stopPropagation(),n.x.duluncheWnd.style.setProperty("display","none")}},"X"]]],["div",{style:{margin:"0 auto"}},[(0,l.h)([["button",{class:"dlc-btn",$click:()=>{(0,e.qb)("#桐生ココ \n#ココここ \n#たつのこ \n","",!1)}},"复制Tags"]]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{}},"Tags管理"]]),(0,l.h)([["button",{class:"dlc-btn",$click:()=>{}},"定型文管理"]]),(0,l.bE)({label:"复制的次要Tags数量:",name:"nTags",type:"input",props:{type:"number",min:0,placeholder:1,style:{width:"48px",margin:"1px"}},helpDesc:"复制的次要tags数量。点击复制tags时，所有主要tags和指定数量的随机次要tags都会被复制。"}),["div",{},"圣 经 咏 唱"]].concat(o),e=>{n.x.configFieldContainer=e}]])};var f=__webpack_require__(126),v=__webpack_require__(484);let y=!1;var w=__webpack_require__(601);const C={map:[],default:()=>{console.log("default router")},finish:()=>{},add:(e,t)=>{let n={checker:e,method:t};C.map.push(n)},run:e=>{let t=!1;for(let n=0;n<C.map.length;n++){let o=C.map[n];if(o.checker(e)){o.method(),t=!0;break}}t||C.default(),C.finish()}};(()=>{if(window.top!==window.self)return;const r=GM_info.script.version;if((0,t.ME)("carrierBasedDuluncheCfg"),document.body.appendChild((0,l.h)("style",{},`\n::-webkit-scrollbar {\n  width: 5px;\n}\n.dlc-cmd {\ncolor: ${t.Dc.fontColor};\nbackground: ${t.Dc.backgroundCmd};\noverflow-y: auto;\noverflow-x: hidden;\nz-index: 998;\nposition: fixed;\npadding: 5px;\nwidth: 270px;\nheight: 615px;\n\nfont-size:120%;\nbox-sizing: content-box;\nborder: 1px solid ${t.Dc.border};\nborder-radius: 5px;\nright: 10px;\ntop: 30%;\ndisplay: none;\n}\n.dlc-titlebar {\nuser-select: none;\nbackground-color: ${t.Dc.titlebar};\ndisplay: inline-flex;\nalign-items: center;\nwidth: 100%;\n}\n.dlc-close-btn {\ndisplay: inline-block;\nposition: relative;\ntext-align: center;\nwidth: 19px;\nheight: 19px;\ncolor: ${t.Dc.btnColor};\ncursor: pointer;\nfloat: right;\nmargin-left: 5px;\nmargin-right: 5px;\nbackground-color: black;\nborder: ${t.Dc.btnBorder} 1px solid;\nline-height: 21px;\n}\n.dlc-btn {\ndisplay: inline-block;\nbackground: ${t.Dc.btn};\ncolor: ${t.Dc.btnColor};\nmin-width: 70px;\nheight: 24px;\nmargin: 2px;\n}\n.dlc-textarea {\nbackground: ${t.Dc.textareaBackground};\ncolor: ${t.Dc.textareaColor};\n}\n.dlc-suspension {\nbackground: ${t.Dc.suspension};\ncolor:${t.Dc.btnColor};\noverflow: hidden;\nz-index: 850;\nposition: fixed;\npadding:5px;\ntext-align:center;\nwidth: 85px;\nheight: 22px;\nborder-radius: 5px;\nright: 10px;\ntop: 30%;\n}\n.dlc-toast {\ntop: 10px;\nleft: 10px;\nmax-height: 90vh;\nmax-width: 60vw;\noverflow: auto;\nposition: fixed;\nbackground: ${t.Dc.backgroundToast};\npadding: 16px;\nborder: 1px solid ${t.Dc.border};\nborder-radius: 5px;\n}\n.dlc-alert {\nmax-height: 90vh;\nmax-width: 60vw;\noverflow: auto;\nbackground: ${t.Dc.backgroundToast};\npadding: 16px;\nborder: ${t.Dc.btnBorder} 1px solid;\nposition: absolute;\nleft: 50%;\ntop: 50%;\ntransform: translate(-50%,-50%);\n}\n.dlc-mod-mgr {\n  max-height: 140vh;\n  max-width: 150vw;\n  overflow: auto;\n  background: ${t.Dc.backgroundToast};\n  padding: 16px;\n  border: ${t.Dc.btnBorder} 1px solid;\n  position: fixed;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%,-50%);\n}\n.help-icon::after {\ncontent: '?';\nmargin-left: 4px;\nmargin-right: 4px;\ndisplay: inline-block;\ncolor: ${t.Dc.helpIconColor};\nbackground-color: ${t.Dc.helpIconBackground};\nborder-radius: 50%;\nwidth: 16px;\nheight: 16px;\nline-height: 16px;\ntext-align: center;\nborder: #999 1px solid;\nfont-size: 12px;\n}\n.import-export-icon {\nmargin-right: 4px;\ndisplay: inline-block;\ncolor: ${t.Dc.helpIconColor};\nbackground-color: ${t.Dc.helpIconBackground};\nborder-radius: 50%;\nwidth: 16px;\nheight: 16px;\nline-height: 16px;\ntext-align: center;\nborder: #999 1px solid;\nfont-size: 12px;\n}\n.hide {\ndisplay: none;\n}\n.label{\n  display:block;\n  vertical-align: middle;\n}\n.label, input, select{\n  vertical-align: middle;\n}\n.mui-switch {\n  width: 37px;\n  height: 20px;\n  position: relative;\n  border: 1px solid #dfdfdf;\n  background-color: #fdfdfd;\n  box-shadow: #dfdfdf 0 0 0 0 inset;\n  border-radius: 10px;\n  border-top-left-radius: 10px;\n  border-top-right-radius: 10px;\n  border-bottom-left-radius: 10px;\n  border-bottom-right-radius: 10px;\n  background-clip: content-box;\n  display: inline-block;\n  -webkit-appearance: none;\n  user-select: none;\n  outline: none;\n}\n.mui-switch:before {\n  content: '✈️';\n  width: 18px;\n  height: 18px;\n  text-align: center;\n  line-height: 18px;\n  position: absolute;\n  top: 0px;\n  left: 0;\n  border-radius: 9px;\n  border-top-left-radius: 9px;\n  border-top-right-radius: 9px;\n  border-bottom-left-radius: 9px;\n  border-bottom-right-radius: 9px;\n  background-color: #fff;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);\n}\n.mui-switch:checked {\n  border-color: #64bd63;\n  box-shadow: #64bd63 0 0 0 16px inset;\n  background-color: #64bd63; }\n.mui-switch:checked:before {\n    left: 16px;\n}\n.mui-switch.mui-switch-animbg {\n  transition: background-color ease 0.4s;\n}\n.mui-switch.mui-switch-animbg:before {\n  transition: left 0.3s;\n}\n.mui-switch.mui-switch-animbg:checked {\n  box-shadow: #dfdfdf 0 0 0 0 inset;\n  background-color: #64bd63;\n  transition: border-color 0.4s, background-color ease 0.4s;\n}\n.mui-switch.mui-switch-animbg:checked:before {\n  transition: left 0.3s;\n}\n.mui-switch.mui-switch-anim {\n  transition: border cubic-bezier(0, 0, 0, 1) 0.4s, box-shadow cubic-bezier(0, 0, 0, 1) 0.4s;\n}\n.mui-switch.mui-switch-anim:before {\n  transition: left 0.3s;\n}\n.mui-switch.mui-switch-anim:checked {\n  box-shadow: #64bd63 0 0 0 16px inset;\n  background-color: #64bd63;\n  transition: border ease 0.4s, box-shadow ease 0.4s, background-color ease 1.2s;\n}\n.mui-switch.mui-switch-anim:checked:before {\n  transition: left 0.3s;\n}\n`)),(0,e.Ye)(r),document.location.href.match(/.*:\/\/twitter\.com.*/)){let e=(0,l.h)("div",{class:"dlc-suspension",$click:()=>{(0,l.FN)("蓝桐独轮车开发中 - 目前计划加入的功能包括tags，定型文的复制和管理"),n.x.duluncheWnd.style.setProperty("display","block")}},"蓝桐独轮车");n.x.duluncheWnd=b(r),document.body.appendChild(e),document.body.appendChild(n.x.duluncheWnd)}else{(0,o.T)(),C.add((e=>"https://www.youtube.com/channel_switcher?next=%2Faccount&feature=settings"===e||"https://www.youtube.com/channel_switcher?next=%2Faccount&feature=settings#"===e),w.pj),C.add((e=>e.match(/.*:\/\/accounts\.google\.com\/b\/.*/)),w.rC),C.run(window.location.href),a(t.vc.lowConsume),c(t.vc.lowConsumeChat),n.x.duluncheWnd=x(r);let e=(e=>(0,l.h)("div",{class:"dlc-suspension",$click:()=>{n.x.duluncheWnd.style.setProperty("display","block"),y||(y=!0,(0,l.FN)((0,v.n)(oldVersion=e,newVersion=f.w.version,logs=f.w.logs.split(";"),announcement=f.w.announcement)))}},"初始化中...",(e=>{o.Y.on("dlc.ready",(()=>{e.textContent="舰载机控制台"}),{once:!0},"dlc.ready.default")})))(r);unsafeWindow.dulunche={version:r,config:new Proxy(t.vc,{set(e,t,n){o.Y.emit(`setConfig.${t}`,n)}}),eventBus:o.Y,refs:n.x,components:{Toast:l.FN,ConfigField:l.bE,h:l.h}},(0,i.l)(),(0,n.d)(),(0,h.Bg)(),document.body.appendChild(e),document.body.appendChild(n.x.duluncheWnd)}})()})()})();